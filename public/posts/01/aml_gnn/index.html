<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/MyBlog/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=MyBlog/livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Catching Financial Crime: An AML Classifier Model Using Graph Neural Networks | My personal blog - Datacuriosity</title>
<meta name="keywords" content="GNN, Imbalanced Classification, Financial Crime">
<meta name="description" content="Implementing a topology-aware Graph Neural Network (GNN) to detect money laundering activities from synthetic transaction data, designed to perform under extreme real-world class imbalance.">
<meta name="author" content="Me">
<link rel="canonical" href="http://localhost:1313/MyBlog/posts/01/aml_gnn/">
<link crossorigin="anonymous" href="/MyBlog/assets/css/stylesheet.fd5566c526ae48aadabd950798a2dc3568536401560eae5caac3765a42a9e7b5.css" integrity="sha256-/VVmxSauSKravZUHmKLcNWhTZAFWDq5cqsN2WkKp57U=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/MyBlog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/MyBlog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/MyBlog/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/MyBlog/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/MyBlog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/MyBlog/posts/01/aml_gnn/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="http://localhost:1313/MyBlog/posts/01/aml_gnn/">
  <meta property="og:site_name" content="My personal blog - Datacuriosity">
  <meta property="og:title" content="Catching Financial Crime: An AML Classifier Model Using Graph Neural Networks">
  <meta property="og:description" content="Implementing a topology-aware Graph Neural Network (GNN) to detect money laundering activities from synthetic transaction data, designed to perform under extreme real-world class imbalance.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:tag" content="GNN">
    <meta property="article:tag" content="Imbalanced Classification">
    <meta property="article:tag" content="Financial Crime">
      <meta property="og:image" content="http://localhost:1313/MyBlog/images/principal-cover.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/MyBlog/images/principal-cover.jpg">
<meta name="twitter:title" content="Catching Financial Crime: An AML Classifier Model Using Graph Neural Networks">
<meta name="twitter:description" content="Implementing a topology-aware Graph Neural Network (GNN) to detect money laundering activities from synthetic transaction data, designed to perform under extreme real-world class imbalance.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/MyBlog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Catching Financial Crime: An AML Classifier Model Using Graph Neural Networks",
      "item": "http://localhost:1313/MyBlog/posts/01/aml_gnn/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Catching Financial Crime: An AML Classifier Model Using Graph Neural Networks",
  "name": "Catching Financial Crime: An AML Classifier Model Using Graph Neural Networks",
  "description": "Implementing a topology-aware Graph Neural Network (GNN) to detect money laundering activities from synthetic transaction data, designed to perform under extreme real-world class imbalance.",
  "keywords": [
    "GNN", "Imbalanced Classification", "Financial Crime"
  ],
  "articleBody": "This project tackles one of the most challenging problems in financial security: Anti-Money Laundering (AML) detection üîé. We implemented a cutting-edge Graph Neural Network (GNN)-based classifier to identify potential money laundering (ML) activities using synthetic transaction data.\nOur core innovation is modeling the financial ecosystem as a complex graph structure and developing a custom, topology-aware strategy to handle the extreme class imbalance inherent in real-world AML datasets ($\u003c0.1%$ suspicious cases).\nüí° Why Graphs? Modeling Financial Relationships Money laundering is fundamentally a crime of relationships and flow. Suspicious patterns rarely involve isolated transactions; they emerge from the connections between clients, the direction of funds, and behavioral changes over time.\nTo capture this relational context, we model the financial ecosystem as an Attributed Transaction Graph .\nNodes (Clients): Represent customers. Edges (Transactions): Represent financial interactions or transfers between clients. Attributes: Both nodes and edges are enriched with important AML-related features. üìà Data and Graph Feature Engineering We use synthetic data derived from confirmed criminal cases in LATAM, enriched with attributes crucial to AML investigations. These features allow the GNN to learn a comprehensive risk profile.\nClient (Node) Attributes These features capture the intrinsic risk of a client:\nGeographic Risk Level: Risk associated with the client‚Äôs location. Economic Activity Risk: Risk of the client‚Äôs registered business or profession. Historical Risk Rating: Previous internal compliance scores. Total Transaction Volume: Summary of their financial activity. Transaction (Edge) Attributes These features capture the specific risk of the interaction:\nTransaction Amount: The value of the transfer. Channel Used: ATM, online transfer, branch visit, etc. Number of Interactions: Frequency of transactions between two parties. ‚öñÔ∏è The Imbalance Challenge: A Topology-Aware Strategy AML detection is defined by extreme class imbalance; less than 1 in 1,000 clients may be suspicious. Traditional methods like naive oversampling can create unrealistic synthetic data, while undersampling loses valuable information.\nOur custom topology-aware mask strategy addresses this by focusing the model‚Äôs learning on the geometric neighborhood around confirmed suspicious cases, ensuring realism and relevance in every data split.\n1. Suspicious Node Preservation All confirmed suspicious nodes ($y=1$) are first isolated and split into the standard 70/15/15 ratio for Train, Validation, and Test sets. This guarantees that all three sets contain genuine positive examples.\n2. 2-Hop Neighborhood Extraction (Contextual Negatives) This is the critical step. For every suspicious node, we extract all non-suspicious nodes within 2-hops in the graph. .\nWhy 2-Hops? These nodes often represent intermediaries, money mules, or partners who are structurally linked to the criminal activity but might not be labeled as criminal themselves (yet). They serve as the most relevant ‚Äúcontextual negative‚Äù examples for the model. 3. Realistic Split Assignment The extracted pool of 2-hop neighbors (and a small fallback set of random nodes if needed) is then shuffled and split using the exact same 70/15/15 ratios.\nResult: Each split (Train, Val, Test) maintains a realistic, high-imbalance ratio, but the non-suspicious samples are not random‚Äîthey are structurally adjacent to the suspicious activities the model must learn to detect. 4. Imbalanced Sampling During Training Even with the focused splits, batches can be dominated by non-suspicious nodes. We use ImbalancedSampler within the NeighborLoader from PyTorch Geometric:\nsampler = ImbalancedSampler(data.y, input_nodes=data.train_mask) loader = NeighborLoader( data, num_neighbors=[-1, -1], # full neighbors for local subgraph batch_size=batch_size, sampler=sampler ) This dual approach ensures two key benefits:\nBatch Balancing: Each training batch contains a sufficient, proportional number of suspicious nodes. Subgraph Integrity: NeighborLoader retrieves the full local subgraph around the sampled batch nodes, preserving the crucial connectivity and attribute structure that GNNs rely on. This combination avoids label leakage, maintains real-world imbalance, and focuses the learning on the complex sub-networks where money laundering occurs.\nüß† Model Architecture: Graph Attention Network (GAT) We chose a Graph Attention Network (GAT) for the core classifier .\nAttention Mechanism: GATs use a powerful attention mechanism to assign varying levels of importance to neighboring nodes and their transactions. This is ideal for financial networks where some relationships are critical (large, high-risk transfers) while others are noise. Attribute Integration: The initial layers are customized to seamlessly integrate both the node (client) and edge (transaction) attributes into the message-passing framework. Robustness: The use of multi-head attention improves robustness and generalization in noisy, irregular financial graphs. üìä Evaluation: Focusing on Rare Event Detection Given the extreme imbalance, standard accuracy is misleading. We rely on metrics tailored for rare event detection:\nBalanced Accuracy: The arithmetic mean of sensitivity (True Positive Rate) and specificity (True Negative Rate). Precision, Recall, and F1-score: Crucial for managing the trade-off between detecting true positives and minimizing false alerts. ROC-AUC: Measures the model‚Äôs ability to discriminate between positive and negative classes. Confusion Matrix: Provides a clear visual breakdown of true/false positives and negatives. üöÄ Key Takeaways \u0026 Project Features This project delivers an end-to-end AML graph learning pipeline that is uniquely suited for operational risk detection:\nTopology-Aware Sampling: Custom strategy to preserve the relational context around suspicious cases. Feature-Rich Model: Seamless integration of detailed node- and edge-level AML attributes. GAT Architecture: Optimized for capturing directional and weighted importance in transaction flows. Real-World Imbalance: Model training and evaluation preserve realistic class proportions. Find the complete code and detailed documentation on GitHub: Link\n",
  "wordCount" : "857",
  "inLanguage": "en",
  "image": "http://localhost:1313/MyBlog/images/principal-cover.jpg","datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Me"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/MyBlog/posts/01/aml_gnn/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "My personal blog - Datacuriosity",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/MyBlog/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/MyBlog/" accesskey="h" title="My personal blog - Datacuriosity (Alt + H)">My personal blog - Datacuriosity</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/MyBlog/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/MyBlog/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/MyBlog/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/MyBlog/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/MyBlog/">Home</a>&nbsp;¬ª&nbsp;<a href="http://localhost:1313/MyBlog/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Catching Financial Crime: An AML Classifier Model Using Graph Neural Networks
    </h1>
    <div class="post-description">
      Implementing a topology-aware Graph Neural Network (GNN) to detect money laundering activities from synthetic transaction data, designed to perform under extreme real-world class imbalance.
    </div>
    <div class="post-meta"><span>5 min</span>&nbsp;¬∑&nbsp;<span>Me</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#-why-graphs-modeling-financial-relationships" aria-label="üí° Why Graphs? Modeling Financial Relationships">üí° Why Graphs? Modeling Financial Relationships</a></li>
                <li>
                    <a href="#-data-and-graph-feature-engineering" aria-label="üìà Data and Graph Feature Engineering">üìà Data and Graph Feature Engineering</a><ul>
                        
                <li>
                    <a href="#client-node-attributes" aria-label="Client (Node) Attributes">Client (Node) Attributes</a></li>
                <li>
                    <a href="#transaction-edge-attributes" aria-label="Transaction (Edge) Attributes">Transaction (Edge) Attributes</a></li></ul>
                </li>
                <li>
                    <a href="#-the-imbalance-challenge-a-topology-aware-strategy" aria-label="‚öñÔ∏è The Imbalance Challenge: A Topology-Aware Strategy">‚öñÔ∏è The Imbalance Challenge: A Topology-Aware Strategy</a><ul>
                        
                <li>
                    <a href="#1-suspicious-node-preservation" aria-label="1. Suspicious Node Preservation">1. Suspicious Node Preservation</a></li>
                <li>
                    <a href="#2-2-hop-neighborhood-extraction-contextual-negatives" aria-label="2. 2-Hop Neighborhood Extraction (Contextual Negatives)">2. 2-Hop Neighborhood Extraction (Contextual Negatives)</a></li>
                <li>
                    <a href="#3-realistic-split-assignment" aria-label="3. Realistic Split Assignment">3. Realistic Split Assignment</a></li>
                <li>
                    <a href="#4-imbalanced-sampling-during-training" aria-label="4. Imbalanced Sampling During Training">4. Imbalanced Sampling During Training</a></li></ul>
                </li>
                <li>
                    <a href="#-model-architecture-graph-attention-network-gat" aria-label="üß† Model Architecture: Graph Attention Network (GAT)">üß† Model Architecture: Graph Attention Network (GAT)</a></li>
                <li>
                    <a href="#-evaluation-focusing-on-rare-event-detection" aria-label="üìä Evaluation: Focusing on Rare Event Detection">üìä Evaluation: Focusing on Rare Event Detection</a></li>
                <li>
                    <a href="#-key-takeaways--project-features" aria-label="üöÄ Key Takeaways &amp; Project Features">üöÄ Key Takeaways &amp; Project Features</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>This project tackles one of the most challenging problems in financial security: <strong>Anti-Money Laundering (AML) detection üîé</strong>. We implemented a cutting-edge <strong>Graph Neural Network (GNN)</strong>-based classifier to identify potential money laundering (ML) activities using synthetic transaction data.</p>
<p>Our core innovation is modeling the financial ecosystem as a complex graph structure and developing a custom, <strong>topology-aware strategy</strong> to handle the extreme class imbalance inherent in real-world AML datasets ($&lt;0.1%$ suspicious cases).</p>
<h2 id="-why-graphs-modeling-financial-relationships">üí° Why Graphs? Modeling Financial Relationships<a hidden class="anchor" aria-hidden="true" href="#-why-graphs-modeling-financial-relationships">#</a></h2>
<p>Money laundering is fundamentally a crime of <strong>relationships and flow</strong>. Suspicious patterns rarely involve isolated transactions; they emerge from the <strong>connections between clients</strong>, the <strong>direction of funds</strong>, and <strong>behavioral changes over time</strong>.</p>
<p>To capture this relational context, we model the financial ecosystem as an <strong>Attributed Transaction Graph</strong> .</p>
<ul>
<li><strong>Nodes (Clients):</strong> Represent customers.</li>
<li><strong>Edges (Transactions):</strong> Represent financial interactions or transfers between clients.</li>
<li><strong>Attributes:</strong> Both nodes and edges are enriched with important AML-related features.</li>
</ul>
<h2 id="-data-and-graph-feature-engineering">üìà Data and Graph Feature Engineering<a hidden class="anchor" aria-hidden="true" href="#-data-and-graph-feature-engineering">#</a></h2>
<p>We use <strong>synthetic data</strong> derived from confirmed criminal cases in LATAM, enriched with attributes crucial to AML investigations. These features allow the GNN to learn a comprehensive risk profile.</p>
<h3 id="client-node-attributes"><strong>Client (Node) Attributes</strong><a hidden class="anchor" aria-hidden="true" href="#client-node-attributes">#</a></h3>
<p>These features capture the intrinsic risk of a client:</p>
<ul>
<li><strong>Geographic Risk Level:</strong> Risk associated with the client&rsquo;s location.</li>
<li><strong>Economic Activity Risk:</strong> Risk of the client&rsquo;s registered business or profession.</li>
<li><strong>Historical Risk Rating:</strong> Previous internal compliance scores.</li>
<li><strong>Total Transaction Volume:</strong> Summary of their financial activity.</li>
</ul>
<h3 id="transaction-edge-attributes"><strong>Transaction (Edge) Attributes</strong><a hidden class="anchor" aria-hidden="true" href="#transaction-edge-attributes">#</a></h3>
<p>These features capture the specific risk of the interaction:</p>
<ul>
<li><strong>Transaction Amount:</strong> The value of the transfer.</li>
<li><strong>Channel Used:</strong> ATM, online transfer, branch visit, etc.</li>
<li><strong>Number of Interactions:</strong> Frequency of transactions between two parties.</li>
</ul>
<h2 id="-the-imbalance-challenge-a-topology-aware-strategy">‚öñÔ∏è The Imbalance Challenge: A Topology-Aware Strategy<a hidden class="anchor" aria-hidden="true" href="#-the-imbalance-challenge-a-topology-aware-strategy">#</a></h2>
<p>AML detection is defined by <strong>extreme class imbalance</strong>; less than 1 in 1,000 clients may be suspicious. Traditional methods like naive oversampling can create unrealistic synthetic data, while undersampling loses valuable information.</p>
<p>Our custom <strong>topology-aware mask strategy</strong> addresses this by focusing the model&rsquo;s learning on the <strong>geometric neighborhood</strong> around confirmed suspicious cases, ensuring realism and relevance in every data split.</p>
<h3 id="1-suspicious-node-preservation"><strong>1. Suspicious Node Preservation</strong><a hidden class="anchor" aria-hidden="true" href="#1-suspicious-node-preservation">#</a></h3>
<p>All confirmed suspicious nodes ($y=1$) are first isolated and split into the standard 70/15/15 ratio for Train, Validation, and Test sets. This guarantees that all three sets contain genuine positive examples.</p>
<h3 id="2-2-hop-neighborhood-extraction-contextual-negatives"><strong>2. 2-Hop Neighborhood Extraction (Contextual Negatives)</strong><a hidden class="anchor" aria-hidden="true" href="#2-2-hop-neighborhood-extraction-contextual-negatives">#</a></h3>
<p>This is the critical step. For every suspicious node, we extract all <strong>non-suspicious nodes within 2-hops</strong> in the graph. .</p>
<ul>
<li><strong>Why 2-Hops?</strong> These nodes often represent <strong>intermediaries</strong>, money mules, or partners who are structurally linked to the criminal activity but might not be labeled as criminal themselves (yet). They serve as the most relevant &ldquo;contextual negative&rdquo; examples for the model.</li>
</ul>
<h3 id="3-realistic-split-assignment"><strong>3. Realistic Split Assignment</strong><a hidden class="anchor" aria-hidden="true" href="#3-realistic-split-assignment">#</a></h3>
<p>The extracted pool of 2-hop neighbors (and a small fallback set of random nodes if needed) is then shuffled and split using the <strong>exact same 70/15/15 ratios</strong>.</p>
<ul>
<li><strong>Result:</strong> Each split (Train, Val, Test) maintains a realistic, high-imbalance ratio, but the non-suspicious samples are not random‚Äîthey are <strong>structurally adjacent</strong> to the suspicious activities the model must learn to detect.</li>
</ul>
<h3 id="4-imbalanced-sampling-during-training"><strong>4. Imbalanced Sampling During Training</strong><a hidden class="anchor" aria-hidden="true" href="#4-imbalanced-sampling-during-training">#</a></h3>
<p>Even with the focused splits, batches can be dominated by non-suspicious nodes. We use <strong><code>ImbalancedSampler</code></strong> within the <strong><code>NeighborLoader</code></strong> from PyTorch Geometric:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">sampler</span> <span class="o">=</span> <span class="n">ImbalancedSampler</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">input_nodes</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">train_mask</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">loader</span> <span class="o">=</span> <span class="n">NeighborLoader</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">num_neighbors</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="c1"># full neighbors for local subgraph</span>
</span></span><span class="line"><span class="cl">    <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">sampler</span><span class="o">=</span><span class="n">sampler</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div><p>This dual approach ensures two key benefits:</p>
<ol>
<li><strong>Batch Balancing:</strong> Each training batch contains a sufficient, proportional number of suspicious nodes.</li>
<li><strong>Subgraph Integrity:</strong> <code>NeighborLoader</code> retrieves the full local subgraph around the sampled batch nodes, preserving the crucial <strong>connectivity and attribute structure</strong> that GNNs rely on.</li>
</ol>
<p>This combination avoids label leakage, maintains real-world imbalance, and focuses the learning on the complex sub-networks where money laundering occurs.</p>
<h2 id="-model-architecture-graph-attention-network-gat">üß† Model Architecture: Graph Attention Network (GAT)<a hidden class="anchor" aria-hidden="true" href="#-model-architecture-graph-attention-network-gat">#</a></h2>
<p>We chose a <strong>Graph Attention Network (GAT)</strong> for the core classifier .</p>
<ul>
<li><strong>Attention Mechanism:</strong> GATs use a powerful <strong>attention mechanism</strong> to assign varying levels of importance to neighboring nodes and their transactions. This is ideal for financial networks where some relationships are critical (large, high-risk transfers) while others are noise.</li>
<li><strong>Attribute Integration:</strong> The initial layers are customized to seamlessly integrate both the <strong>node (client)</strong> and <strong>edge (transaction)</strong> attributes into the message-passing framework.</li>
<li><strong>Robustness:</strong> The use of <strong>multi-head attention</strong> improves robustness and generalization in noisy, irregular financial graphs.</li>
</ul>
<h2 id="-evaluation-focusing-on-rare-event-detection">üìä Evaluation: Focusing on Rare Event Detection<a hidden class="anchor" aria-hidden="true" href="#-evaluation-focusing-on-rare-event-detection">#</a></h2>
<p>Given the extreme imbalance, standard accuracy is misleading. We rely on metrics tailored for rare event detection:</p>
<ul>
<li><strong>Balanced Accuracy:</strong> The arithmetic mean of sensitivity (True Positive Rate) and specificity (True Negative Rate).</li>
<li><strong>Precision, Recall, and F1-score:</strong> Crucial for managing the trade-off between detecting true positives and minimizing false alerts.</li>
<li><strong>ROC-AUC:</strong> Measures the model&rsquo;s ability to discriminate between positive and negative classes.</li>
<li><strong>Confusion Matrix:</strong> Provides a clear visual breakdown of true/false positives and negatives.</li>
</ul>
<h2 id="-key-takeaways--project-features">üöÄ Key Takeaways &amp; Project Features<a hidden class="anchor" aria-hidden="true" href="#-key-takeaways--project-features">#</a></h2>
<p>This project delivers an <strong>end-to-end AML graph learning pipeline</strong> that is uniquely suited for operational risk detection:</p>
<ul>
<li><strong>Topology-Aware Sampling:</strong> Custom strategy to preserve the relational context around suspicious cases.</li>
<li><strong>Feature-Rich Model:</strong> Seamless integration of detailed node- and edge-level AML attributes.</li>
<li><strong>GAT Architecture:</strong> Optimized for capturing directional and weighted importance in transaction flows.</li>
<li><strong>Real-World Imbalance:</strong> Model training and evaluation preserve realistic class proportions.</li>
</ul>
<p>Find the complete code and detailed documentation on GitHub: <a href="https://github.com/cesar1091/AML-Graph-Neural-Network-Imbalance-Classification">Link</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/MyBlog/tags/gnn/">GNN</a></li>
      <li><a href="http://localhost:1313/MyBlog/tags/imbalanced-classification/">Imbalanced Classification</a></li>
      <li><a href="http://localhost:1313/MyBlog/tags/financial-crime/">Financial Crime</a></li>
    </ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/MyBlog/">My personal blog - Datacuriosity</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
